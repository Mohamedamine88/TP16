{"ast":null,"code":"import { ApolloClient, InMemoryCache, ApolloLink, Observable } from \"@apollo/client\";\n\n// Simple in-memory mock server to handle the GraphQL operations used by the app.\n// This allows the frontend to work without a backend during development.\n\nlet nextCompteId = 1;\nlet nextTransactionId = 1;\nconst comptes = [{\n  id: nextCompteId++,\n  solde: 1200,\n  dateCreation: new Date().toLocaleDateString(),\n  type: 'COURANT'\n}, {\n  id: nextCompteId++,\n  solde: 5400,\n  dateCreation: new Date().toLocaleDateString(),\n  type: 'EPARGNE'\n}];\nconst transactions = [{\n  id: nextTransactionId++,\n  type: 'DEPOT',\n  montant: 1200,\n  date: new Date().toLocaleDateString(),\n  compte: {\n    id: 1,\n    solde: 1200,\n    type: 'COURANT'\n  }\n}];\nfunction findCompte(id) {\n  return comptes.find(c => String(c.id) === String(id));\n}\nfunction handleOperation(operation) {\n  const name = operation.operationName;\n  const vars = operation.variables || {};\n  switch (name) {\n    case 'GetAllComptes':\n      return {\n        data: {\n          allComptes: comptes\n        }\n      };\n    case 'GetAllTransactions':\n      return {\n        data: {\n          allTransactions: transactions\n        }\n      };\n    case 'GetCompteById':\n      {\n        const c = findCompte(vars.id);\n        return {\n          data: {\n            compteById: c || null\n          }\n        };\n      }\n    case 'GetCompteTransactions':\n      {\n        const id = vars.id;\n        const list = transactions.filter(t => String(t.compte.id) === String(id));\n        return {\n          data: {\n            compteTransactions: list\n          }\n        };\n      }\n    case 'SaveCompte':\n      {\n        const input = vars.compte || {};\n        if (typeof input.solde !== 'number' || !input.type) {\n          throw new Error('Invalid compte payload');\n        }\n        const newCompte = {\n          id: nextCompteId++,\n          solde: input.solde,\n          dateCreation: new Date().toLocaleDateString(),\n          type: input.type\n        };\n        comptes.push(newCompte);\n        return {\n          data: {\n            saveCompte: newCompte\n          }\n        };\n      }\n    case 'AddTransaction':\n      {\n        const tr = vars.transactionRequest || {};\n        const compte = findCompte(tr.compteId);\n        if (!compte) throw new Error('Compte introuvable');\n        const montant = parseFloat(tr.montant) || 0;\n        const type = tr.type;\n\n        // update compte solde\n        if (type === 'DEPOT') compte.solde = Number(compte.solde) + montant;else if (type === 'RETRAIT') compte.solde = Number(compte.solde) - montant;\n        const newTransaction = {\n          id: nextTransactionId++,\n          type,\n          montant,\n          date: new Date().toLocaleDateString(),\n          compte: {\n            id: compte.id,\n            solde: compte.solde,\n            type: compte.type\n          }\n        };\n        transactions.unshift(newTransaction);\n        return {\n          data: {\n            addTransaction: newTransaction\n          }\n        };\n      }\n    case 'DeleteCompte':\n      {\n        const id = vars.id;\n        const idx = comptes.findIndex(c => String(c.id) === String(id));\n        if (idx === -1) return {\n          data: {\n            deleteCompte: false\n          }\n        };\n        comptes.splice(idx, 1);\n        // remove related transactions\n        for (let i = transactions.length - 1; i >= 0; i--) {\n          if (String(transactions[i].compte.id) === String(id)) transactions.splice(i, 1);\n        }\n        return {\n          data: {\n            deleteCompte: true\n          }\n        };\n      }\n    case 'GetTotalSolde':\n      {\n        const sum = comptes.reduce((s, c) => s + Number(c.solde || 0), 0);\n        const count = comptes.length;\n        const average = count ? sum / count : 0;\n        return {\n          data: {\n            totalSolde: {\n              count,\n              sum,\n              average\n            }\n          }\n        };\n      }\n    case 'GetCompteByType':\n      {\n        const list = comptes.filter(c => c.type === vars.type);\n        return {\n          data: {\n            findCompteByType: list\n          }\n        };\n      }\n    case 'GetTransactionStats':\n      {\n        const count = transactions.length;\n        const sumDepots = transactions.filter(t => t.type === 'DEPOT').reduce((s, t) => s + Number(t.montant || 0), 0);\n        const sumRetraits = transactions.filter(t => t.type === 'RETRAIT').reduce((s, t) => s + Number(t.montant || 0), 0);\n        return {\n          data: {\n            transactionStats: {\n              count,\n              sumDepots,\n              sumRetraits\n            }\n          }\n        };\n      }\n    default:\n      throw new Error(`Opération GraphQL inconnue ou non supportée par le mock: ${name}`);\n  }\n}\nconst mockLink = new ApolloLink(operation => new Observable(observer => {\n  // Simulate network latency\n  const id = setTimeout(() => {\n    try {\n      const result = handleOperation(operation);\n      observer.next(result);\n      observer.complete();\n    } catch (err) {\n      observer.error(err);\n    }\n  }, 150);\n  return () => clearTimeout(id);\n}));\nexport const client = new ApolloClient({\n  link: mockLink,\n  cache: new InMemoryCache()\n});","map":{"version":3,"names":["ApolloClient","InMemoryCache","ApolloLink","Observable","nextCompteId","nextTransactionId","comptes","id","solde","dateCreation","Date","toLocaleDateString","type","transactions","montant","date","compte","findCompte","find","c","String","handleOperation","operation","name","operationName","vars","variables","data","allComptes","allTransactions","compteById","list","filter","t","compteTransactions","input","Error","newCompte","push","saveCompte","tr","transactionRequest","compteId","parseFloat","Number","newTransaction","unshift","addTransaction","idx","findIndex","deleteCompte","splice","i","length","sum","reduce","s","count","average","totalSolde","findCompteByType","sumDepots","sumRetraits","transactionStats","mockLink","observer","setTimeout","result","next","complete","err","error","clearTimeout","client","link","cache"],"sources":["C:/Users/user/Desktop/5IIR_Cours/Architecture des composants/TP_16_React_GraphQL_ApolloClient/src/apollo/client.js"],"sourcesContent":["import { ApolloClient, InMemoryCache, ApolloLink, Observable } from \"@apollo/client\";\n\n// Simple in-memory mock server to handle the GraphQL operations used by the app.\n// This allows the frontend to work without a backend during development.\n\nlet nextCompteId = 1;\nlet nextTransactionId = 1;\n\nconst comptes = [\n  { id: nextCompteId++, solde: 1200, dateCreation: new Date().toLocaleDateString(), type: 'COURANT' },\n  { id: nextCompteId++, solde: 5400, dateCreation: new Date().toLocaleDateString(), type: 'EPARGNE' },\n];\n\nconst transactions = [\n  { id: nextTransactionId++, type: 'DEPOT', montant: 1200, date: new Date().toLocaleDateString(), compte: { id: 1, solde: 1200, type: 'COURANT' } },\n];\n\nfunction findCompte(id) {\n  return comptes.find(c => String(c.id) === String(id));\n}\n\nfunction handleOperation(operation) {\n  const name = operation.operationName;\n  const vars = operation.variables || {};\n\n  switch (name) {\n    case 'GetAllComptes':\n      return { data: { allComptes: comptes } };\n\n    case 'GetAllTransactions':\n      return { data: { allTransactions: transactions } };\n\n    case 'GetCompteById':\n      {\n        const c = findCompte(vars.id);\n        return { data: { compteById: c || null } };\n      }\n\n    case 'GetCompteTransactions':\n      {\n        const id = vars.id;\n        const list = transactions.filter(t => String(t.compte.id) === String(id));\n        return { data: { compteTransactions: list } };\n      }\n\n    case 'SaveCompte':\n      {\n        const input = vars.compte || {};\n        if (typeof input.solde !== 'number' || !input.type) {\n          throw new Error('Invalid compte payload');\n        }\n        const newCompte = {\n          id: nextCompteId++,\n          solde: input.solde,\n          dateCreation: new Date().toLocaleDateString(),\n          type: input.type,\n        };\n        comptes.push(newCompte);\n        return { data: { saveCompte: newCompte } };\n      }\n\n    case 'AddTransaction':\n      {\n        const tr = vars.transactionRequest || {};\n        const compte = findCompte(tr.compteId);\n        if (!compte) throw new Error('Compte introuvable');\n        const montant = parseFloat(tr.montant) || 0;\n        const type = tr.type;\n\n        // update compte solde\n        if (type === 'DEPOT') compte.solde = Number(compte.solde) + montant;\n        else if (type === 'RETRAIT') compte.solde = Number(compte.solde) - montant;\n\n        const newTransaction = {\n          id: nextTransactionId++,\n          type,\n          montant,\n          date: new Date().toLocaleDateString(),\n          compte: { id: compte.id, solde: compte.solde, type: compte.type },\n        };\n        transactions.unshift(newTransaction);\n        return { data: { addTransaction: newTransaction } };\n      }\n\n    case 'DeleteCompte':\n      {\n        const id = vars.id;\n        const idx = comptes.findIndex(c => String(c.id) === String(id));\n        if (idx === -1) return { data: { deleteCompte: false } };\n        comptes.splice(idx, 1);\n        // remove related transactions\n        for (let i = transactions.length - 1; i >= 0; i--) {\n          if (String(transactions[i].compte.id) === String(id)) transactions.splice(i, 1);\n        }\n        return { data: { deleteCompte: true } };\n      }\n\n    case 'GetTotalSolde':\n      {\n        const sum = comptes.reduce((s, c) => s + Number(c.solde || 0), 0);\n        const count = comptes.length;\n        const average = count ? sum / count : 0;\n        return { data: { totalSolde: { count, sum, average } } };\n      }\n\n    case 'GetCompteByType':\n      {\n        const list = comptes.filter(c => c.type === vars.type);\n        return { data: { findCompteByType: list } };\n      }\n\n    case 'GetTransactionStats':\n      {\n        const count = transactions.length;\n        const sumDepots = transactions.filter(t => t.type === 'DEPOT').reduce((s, t) => s + Number(t.montant || 0), 0);\n        const sumRetraits = transactions.filter(t => t.type === 'RETRAIT').reduce((s, t) => s + Number(t.montant || 0), 0);\n        return { data: { transactionStats: { count, sumDepots, sumRetraits } } };\n      }\n\n    default:\n      throw new Error(`Opération GraphQL inconnue ou non supportée par le mock: ${name}`);\n  }\n}\n\nconst mockLink = new ApolloLink((operation) =>\n  new Observable((observer) => {\n    // Simulate network latency\n    const id = setTimeout(() => {\n      try {\n        const result = handleOperation(operation);\n        observer.next(result);\n        observer.complete();\n      } catch (err) {\n        observer.error(err);\n      }\n    }, 150);\n\n    return () => clearTimeout(id);\n  })\n);\n\nexport const client = new ApolloClient({\n  link: mockLink,\n  cache: new InMemoryCache(),\n});\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}